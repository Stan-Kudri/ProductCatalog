@using ProductCatalog.Core.DataTable
@using ProductCatalog.MudBlazors
@using ProductCatalog.MudBlazors.Pages
@using ProductCatalog.MudBlazors.Pages.Import
@using ProductCatalog.MudBlazors.Shared

<MudDialog>
    <DialogContent>
        <MudSelect T="Table" Label="Select table" MultiSelection="true" @bind-Value="_selectedTable.Table"
                   @bind-SelectedValues="_selectedTable.SelectTables" SelectAll="true" SelectAllText="All">
            @foreach (var item in _selectedTable.Items)
            {
                <MudSelectItem T="Table" Value="@item" />
            }
        </MudSelect>        
    </DialogContent>
    <DialogActions>        
        <MudContainer Style="align-items:center">
            <MudFileUpload T="IBrowserFile" Accept=".xlsx,.xls,.xlsm" FilesChanged="UploadData">
                <ActivatorContent>
                    <ButtonTemplate>
                        <MudButton HtmlTag="label"
                                   Style="max-width: 60px; max-height: 30px;"
                                   Variant="Variant.Filled"
                                   Class="mr-4"         
                                   title="Import Excel">Ok</MudButton>
                        <MudButton OnClick="Cancel" 
                                   Style="max-width: 60px; max-height: 30px;" 
                                   Variant="Variant.Filled">Cancel</MudButton>
                    </ButtonTemplate>
                </ActivatorContent>
            </MudFileUpload>
        </MudContainer>          
    </DialogActions>
</MudDialog>
