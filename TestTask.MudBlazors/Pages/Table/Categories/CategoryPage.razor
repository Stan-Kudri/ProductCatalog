@page "/category"

@using Bromix.MudBlazor.MaterialDesignIcons
@using TestTask.Core.Models.Categories
@using TestTask.Core.Models.Companies

<PageTitle>Category</PageTitle>
<MudText Typo="Typo.h5" Align="Align.Center" GutterBottom="true">Category</MudText>
<MudTable Items="@categories" Hover="true" SortLabel="Sort By" Elevation="0" @bind-SelectedItems="selectedItems" MultiSelection="true">
    <ToolBarContent>
        <MudSpacer />
        <MudTextField T="string" ValueChanged="@(s=>OnSearch(s))" Placeholder="Search" Adornment="Adornment.Start"
                      AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
        <MudToggleIconButton @bind-Toggled="@IsAscending"
                             Icon="@MaterialDesignIcons.Normal.SortAlphabeticalDescending" Color="@Color.Primary" Title="Descending" Size="Size.Large"
                             ToggledIcon="@MaterialDesignIcons.Normal.SortAlphabeticalAscending" ToggledColor="@Color.Primary" ToggledTitle="Ascending" ToggledSize="Size.Large" />

        <MudSelect T="SortType" Label="Sort" MultiSelection="true" @bind-Value="sortField.sortType" @bind-SelectedValues="sortField.SortFields"
                   SelectAll="true" SelectAllText="Sort by all columns" AdornmentIcon="@Icons.Material.Filled.Search">
            @foreach (var state in sortField.Items)
            {
                <MudSelectItem T="SortType" Value="@state" />
            }
        </MudSelect>
        <MudSpacer />
        <MudTooltip Text="Use Filter" Placement="Placement.Top">
            <MudIconButton Icon="@Icons.Material.Filled.Search" Color="Color.Tertiary" OnClick="@UseFilter" />
        </MudTooltip>
        <MudTooltip Text="Remove Filter" Placement="Placement.Top">
            <MudIconButton Icon="@MaterialDesignIcons.Normal.FilterOff" Color="Color.Warning" OnClick="@ClearFilter" />
        </MudTooltip>
        <MudTooltip Text="Add Item" Placement="Placement.Top">
            <MudIconButton Icon="@Icons.Material.Filled.Add" Color="Color.Tertiary" OnClick="@AddCategoryPage" />
        </MudTooltip>
        <MudTooltip Text="Remove Select Items" Placement="Placement.Top">
            <MudIconButton Icon="@Icons.Material.Filled.Delete" Color="Color.Secondary" OnClick="@Remove" />
        </MudTooltip>
    </ToolBarContent>
    <ColGroup>
        <col style="width: 60px;"/>
        <col style="width: 20%;" />
        <col style="width: 40px;" />
    </ColGroup>
    <HeaderContent>
        <MudTh >Id</MudTh>
        <MudTh >Name</MudTh>
        <MudTh></MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd DataLabel="Id" >@context.Id</MudTd>
        <MudTd DataLabel="Name" >@context.Name</MudTd>
        <MudTh Style="text-align:right">
            <MudTooltip Text="Remove" Placement="Placement.Bottom">
                <MudIconButton Color="Color.Secondary" Icon="@Icons.Material.Filled.Delete" Variant="Variant.Filled" Size="Size.Medium" OnClick="@(() => Remove(context.Id))" />
            </MudTooltip>
            <MudTooltip Text="Edit" Placement="Placement.Bottom">
                <MudIconButton Color="Color.Warning" Icon="@Icons.Material.Filled.Edit" Variant="Variant.Filled" Size="Size.Medium" Class="ml-1" OnClick="@(() => Update(context.Id))" />
            </MudTooltip>
        </MudTh>
    </RowTemplate>
    <PagerContent>
        <MudTablePager PageSizeOptions="pageModel.Items" />
    </PagerContent>
</MudTable>
